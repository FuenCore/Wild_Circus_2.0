{"ast":null,"code":"import _slicedToArray from \"/home/fuencode/Documents/WildCodeSchool/checkpoint/Wild_Circus_2.0/front/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/fuencode/Documents/WildCodeSchool/checkpoint/Wild_Circus_2.0/front/src/components/ChatPage.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport './ChatPage.css';\nimport Axios from 'axios';\nimport BgGlitch from './BgGlitch';\nimport NavBar from \"./NavBar\";\nimport { AuthContext } from './auth/Auth';\n\nconst ChatPage = () => {\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        messages = _useState2[0],\n        setMessages = _useState2[1];\n\n  const _useState3 = useState(0),\n        _useState4 = _slicedToArray(_useState3, 2),\n        antiSpam = _useState4[0],\n        setAntiSpam = _useState4[1];\n\n  const _useState5 = useState(),\n        _useState6 = _slicedToArray(_useState5, 2),\n        message = _useState6[0],\n        setMessage = _useState6[1];\n\n  const _useState7 = useState(null),\n        _useState8 = _slicedToArray(_useState7, 2),\n        need2BeDestroy = _useState8[0],\n        setneed2BeDestroy = _useState8[1];\n\n  const dataUser = React.useContext(AuthContext);\n  const pseudo = dataUser && dataUser.userInfo && dataUser.userInfo.pseudo || 'Stranger';\n  const defaultAvatar = 'https://image.freepik.com/vector-gratis/payaso-aterrador-sombrero-rojo_43623-432.jpg';\n  const avatar = dataUser && dataUser.userInfo && dataUser.userInfo.avatar || defaultAvatar;\n  const isAdmin = dataUser && dataUser.userInfo && dataUser.userInfo.admin;\n  useEffect(() => {\n    refreshChat();\n  }, []);\n\n  const refreshChat = () => {\n    Axios.get('http://localhost:5000/api/chat').then(response => response.data).then(data => setMessages(data));\n    setTimeout(refreshChat, 5000);\n  };\n\n  let wow = new Date();\n  let annee = wow.getFullYear();\n  let mois = wow.getMonth() + 1;\n  let jour = wow.getDate();\n  let heure = wow.getHours();\n  let minute = wow.getMinutes();\n  const hour = heure + ':' + minute;\n  const date = jour + '/' + mois + '/' + annee;\n\n  const checkAntiSpam = () => {\n    if (antiSpam === 0) {\n      return postMessage();\n    } else if (antiSpam === 1) {\n      return alert('Pas de spam ici !');\n    }\n  };\n\n  const postMessage = () => {\n    Axios.post('http://localhost:5000/api/chat', {\n      pseudo: pseudo,\n      date: date,\n      hour: hour,\n      message: message,\n      avatar: avatar\n    }).then(setAntiSpam(1)).then(setTimeout(() => setAntiSpam(0), 5000));\n  };\n\n  const destroyMessage = () => {\n    Axios.delete(`http://localhost:5000/api/chat/${need2BeDestroy}`).then(console.log(\"Message detruit\"));\n  };\n\n  if (need2BeDestroy != null) {\n    return removePlace();\n  }\n\n  return React.createElement(\"div\", {\n    className: \"ChatPage_container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"Main_navBar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, React.createElement(NavBar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"ChatPage_BgGlitch\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(BgGlitch, {\n    title: \"MADE BY FUENCORE\",\n    glitch: \"-1- -1- 1 -1- \",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"ChatPage_read\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, messages.map(x => React.createElement(\"div\", {\n    className: \"ChatPage_read_container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ChatPage_text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ChatPage_read_container_info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"ChatPage_read_container_pseudo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, x.pseudo), React.createElement(\"p\", {\n    className: \"ChatPage_read_container_date\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, x.date, \" \\xE0 \", x.hour), isAdmin === 1 ? React.createElement(\"button\", {\n    onClick: () => setneed2BeDestroy(x.id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, \"DESTROY\") : null), React.createElement(\"div\", {\n    className: \"ChatPage_read_container_message\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"ChatPage_read_message\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, x.message))), React.createElement(\"img\", {\n    src: x.avatar,\n    id: \"ChatPage_avatar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    id: \"scrollToMe\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"ChatPage_write\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, React.createElement(\"textarea\", {\n    required: \"required\",\n    type: \"text\",\n    className: \"ChatPage_textarea\",\n    onChange: e => setMessage(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    type: \"sumbit\",\n    className: \"ChatPage_sendbutton\",\n    onClick: () => checkAntiSpam(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, antiSpam === 1 ? 'Attendez 5s' : 'Envoyer le message')));\n};\n\nexport default ChatPage;","map":{"version":3,"sources":["/home/fuencode/Documents/WildCodeSchool/checkpoint/Wild_Circus_2.0/front/src/components/ChatPage.jsx"],"names":["React","useState","useEffect","Axios","BgGlitch","NavBar","AuthContext","ChatPage","messages","setMessages","antiSpam","setAntiSpam","message","setMessage","need2BeDestroy","setneed2BeDestroy","dataUser","useContext","pseudo","userInfo","defaultAvatar","avatar","isAdmin","admin","refreshChat","get","then","response","data","setTimeout","wow","Date","annee","getFullYear","mois","getMonth","jour","getDate","heure","getHours","minute","getMinutes","hour","date","checkAntiSpam","postMessage","alert","post","destroyMessage","delete","console","log","removePlace","map","x","id","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './ChatPage.css';\nimport Axios from 'axios';\nimport BgGlitch from './BgGlitch';\nimport NavBar from \"./NavBar\";\nimport { AuthContext } from './auth/Auth';\n\nconst ChatPage = () => {\n\tconst [ messages, setMessages ] = useState([]);\n\tconst [ antiSpam, setAntiSpam ] = useState(0);\n    const [ message, setMessage ] = useState();\n    const [ need2BeDestroy, setneed2BeDestroy ] = useState(null)\n\n\tconst dataUser = React.useContext(AuthContext);\n\n\tconst pseudo = (dataUser && dataUser.userInfo && dataUser.userInfo.pseudo) || 'Stranger';\n\n\tconst defaultAvatar = 'https://image.freepik.com/vector-gratis/payaso-aterrador-sombrero-rojo_43623-432.jpg';\n    const avatar = (dataUser && dataUser.userInfo && dataUser.userInfo.avatar) || defaultAvatar;\n    const isAdmin = (dataUser && dataUser.userInfo && dataUser.userInfo.admin)\n\n\tuseEffect(() => {\n\t\trefreshChat();\n\t}, []);\n\n\tconst refreshChat = () => {\n\t\tAxios.get('http://localhost:5000/api/chat').then((response) => response.data).then((data) => setMessages(data));\n\t\tsetTimeout(refreshChat, 5000);\n\t};\n\n\tlet wow = new Date();\n\tlet annee = wow.getFullYear();\n\tlet mois = wow.getMonth() + 1;\n\tlet jour = wow.getDate();\n\tlet heure = wow.getHours();\n\tlet minute = wow.getMinutes();\n\tconst hour = heure + ':' + minute;\n\tconst date = jour + '/' + mois + '/' + annee;\n\n\tconst checkAntiSpam = () => {\n\t\tif (antiSpam === 0) {\n\t\t\treturn postMessage();\n\t\t} else if (antiSpam === 1) {\n\t\t\treturn alert('Pas de spam ici !');\n\t\t}\n\t};\n\n\tconst postMessage = () => {\n\t\tAxios.post('http://localhost:5000/api/chat', {\n\t\t\tpseudo: pseudo,\n\t\t\tdate: date,\n\t\t\thour: hour,\n\t\t\tmessage: message,\n\t\t\tavatar: avatar\n\t\t})\n\t\t\t.then(setAntiSpam(1))\n\t\t\t.then(setTimeout(() => setAntiSpam(0), 5000));\n    };\n    \n    const destroyMessage = () => {\n        Axios.delete(`http://localhost:5000/api/chat/${need2BeDestroy}`).then(console.log(\"Message detruit\"))\n    }\n\n    if(need2BeDestroy != null) {\n        return removePlace();\n    }\n\n\treturn (\n\t\t<div className=\"ChatPage_container\">\n\t\t\t<div className=\"Main_navBar\">\n\t\t\t\t<NavBar />\n\t\t\t</div>\n\t\t\t<div className=\"ChatPage_BgGlitch\">\n\t\t\t\t<BgGlitch title=\"MADE BY FUENCORE\" glitch=\"-1- -1- 1 -1- \" />\n\t\t\t</div>\n\t\t\t<div className=\"ChatPage_read\">\n\t\t\t\t{messages.map((x) => (\n\t\t\t\t\t<div className=\"ChatPage_read_container\">\n\t\t\t\t\t\t<div className=\"ChatPage_text\">\n\t\t\t\t\t\t\t<div className=\"ChatPage_read_container_info\">\n\t\t\t\t\t\t\t\t<p className=\"ChatPage_read_container_pseudo\">{x.pseudo}</p>\n\t\t\t\t\t\t\t\t<p className=\"ChatPage_read_container_date\">\n\t\t\t\t\t\t\t\t\t{x.date} à {x.hour}\n\t\t\t\t\t\t\t\t</p>\n                               {(isAdmin === 1) ? <button onClick={() => setneed2BeDestroy(x.id)}>DESTROY</button> : null}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"ChatPage_read_container_message\">\n\t\t\t\t\t\t\t\t<p className=\"ChatPage_read_message\">{x.message}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<img src={x.avatar} id=\"ChatPage_avatar\" />\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t\t<div id=\"scrollToMe\" />\n\t\t\t</div>\n\t\t\t<div className=\"ChatPage_write\">\n\t\t\t\t<textarea\n\t\t\t\t\trequired=\"required\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName=\"ChatPage_textarea\"\n\t\t\t\t\tonChange={(e) => setMessage(e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<button type=\"sumbit\" className=\"ChatPage_sendbutton\" onClick={() => checkAntiSpam()}>\n\t\t\t\t\t{antiSpam === 1 ? 'Attendez 5s' : 'Envoyer le message'}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default ChatPage;\n"]},"metadata":{},"sourceType":"module"}